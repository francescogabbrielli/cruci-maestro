  <input class="input" size="1" maxlength="1" type="text" maxlength="1" tabindex="1" [(ngModel)]="input"
    (focus)="onFocus($event)" (blur)="onBlur()" (input)="onInput($event)">
  <table class="schema noselect">
    <tr *ngFor="let row of service.cells; index as i; last as lastRow">
      <td *ngFor="let cell of row; index as j; last as lastColumn"
        (mousedown)="prepareDrag(i, j, lastRow && lastColumn, $event)"
        (dblclick)="toggleOrientation()">
        <div *ngIf="cell==='.'" class="block"
          [style.width]="cellSize+'px'" [style.height]="cellSize+'px'">
        </div>
        <div *ngIf="j==state.x && i==state.y" class="cursor"
          [style.width]="cellSize+'px'" [style.height]="cellSize+'px'">
        </div>
        <div id="cell-{{i}}-{{j}}" class="cell"
          [style.width]="cellSize+'px'" [style.height]="cellSize+'px'"
          [style.font-size]="(3+cellSize/2)+'px'"
          [style.border-color]="selection.unused ? 'red' : ''"
          [ngClass]="{
              'word-sh': state.horizontal && selection.startsWith(j,i),
              'word-h': state.horizontal && selection.contains(j,i),
              'word-eh': state.horizontal && selection.endsWith(j,i),
              'word-sv': !state.horizontal && selection.startsWith(j,i),
              'word-v': !state.horizontal && selection.contains(j,i),
              'word-ev': !state.horizontal && selection.endsWith(j,i),
              'focused': state.focused && cell!=='.'
              }">
          {{cell}}
        </div>
      </td>
    </tr>
  </table>
  <defs [state]="state" [selection]="selection"></defs>
  <span tabindex="3" onFocus="document.querySelector('.input').focus()"></span>
